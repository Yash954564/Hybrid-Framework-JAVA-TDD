package com.smartData.BuisnessLogic;

import java.io.File;
import java.io.IOException;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;

import com.relevantcodes.extentreports.ExtentReports;
import com.relevantcodes.extentreports.ExtentTest;
import com.relevantcodes.extentreports.LogStatus;

public class HTMLReportGenerator {
	private static ExtentReports report;
//	WebDriver driver = new ChromeDriver();
	private static WebDriver driver = DriverSetup.getDriver();

	static {
	    report = new ExtentReports(System.getProperty("user.dir") + "//Reports//ExtentReport//" + "ExtentReportResults"+System.currentTimeMillis()+".html");
	}
	
    public String capture(WebDriver driver, String Name)throws IOException {
        File scrFile = ((TakesScreenshot) driver).getScreenshotAs(OutputType.FILE);
        File Dest = new File(System.getProperty("user.dir") + "//Reports//Screenshots//"+Name+"" + System.currentTimeMillis()
                + ".png");
        String errflpath = Dest.getAbsolutePath();
        FileUtils.copyFile(scrFile, Dest);
        return errflpath;
    }


    public void ExtentReportTest(String TestCase, String status, String Testdetails) throws IOException {
        ExtentTest test = report.startTest(TestCase);

        if (status.equalsIgnoreCase("Pass")) {
            test.log(LogStatus.PASS, test.addScreenCapture(capture(driver, TestCase)) + Testdetails);
            
        } else {
            test.log(LogStatus.FAIL, test.addScreenCapture(capture(driver, TestCase)) + Testdetails);
        }

        report.flush();
    }
	
}
